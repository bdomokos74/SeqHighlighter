<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
    <script src="jquery-1.10.1.min.js"></script>
    <script src="jquery-migrate-1.2.1.min.js"></script>
    <script>
        window.kvalue = 9
        window.kmers = [[5, ["ATACTACTA", [50, 53], "TAGTAGTAT", [126, 151, 154]], ["TACTACTAT", [51, 54], "ATAGTAGTA", [125, 150, 153]], ["CTACTACTA", [50, 53, 56], "TAGTAGTAG", [151, 154]], ["ATTACTACT", [49, 52, 55], "AGTAGTAAT", [152, 155]], ["TACTACTAA", [51, 54, 57], "TTAGTAGTA", [150, 153]]], [4, ["GACTACTAC", [48, 51, 54], "GTAGTAGTC", [153]], ["CCTACTACT", [9, 52, 55], "AGTAGTAGG", [152]], ["TATTACTAC", [48, 51, 54], "GTAGTAATA", [153]], ["CTACTACTT", [10, 53, 56], "AAGTAGTAG", [151]], ["ACTCCTACT", [9, 52, 55], "AGTAGGAGT", [152]]], [2, ["CTTCTCCCT", [3], "AGGGAGAAG", [173]], ["TCCGTCCTA", [7, 72], "TAGGACGGA", []], ["AATTATCCC", [2, 106], "GGGATAATT", []], ["ATTCTCCTT", [3], "AAGGAGAAT", [173]], ["AAATTTTCC", [1, 105], "GGAAAATTT", []], ["AAATTATCC", [1], "GGATAATTT", [102]], ["AATTTTCCC", [2, 106], "GGGAAAATT", []], ["TTCTCCTTC", [4], "GAAGGAGAA", [172]], ["ATTCTCCCC", [3, 107], "GGGGAGAAT", []], ["TCCCTCTTA", [7, 72], "TAAGAGGGA", []], ["AAATTCTAC", [1], "GTAGAATTT", [102]], ["AATTCTCCC", [2, 106], "GGGAGAATT", []], ["ATTTTCCCT", [3, 107], "AGGGAAAAT", []], ["TAATTCTCC", [1, 105], "GGAGAATTA", []], ["AATTGTCCC", [2, 106], "GGGACAATT", []], ["TTCTCCCTT", [4], "AAGGGAGAA", [172]]]]
;
        window.seqlen = 188;
    </script>
    <style>
        .seq_type span {
            font-family: monospace,"Courier New";
        }
        .sel_seq {
            color: royalblue;
            font-weight: bold;
        }
        .rev_seq {
            color: coral;
            font-weight: bold;
        }
        .overlap_seq {
            background-color: lightgray;
            font-weight: bold;
        }
        .mismatch_seq {
            color: red;
            font-weight: bold;
        }
        .kmer_pair {
            white-space: nowrap;
            cursor: pointer;
        }
        .selected_item {
            background-color: lightgray;
        }
        .kmer_list {
            font-family: monospace,"Courier New";
            width: 800px;
        }
    </style>
</head>
<body>
    <h2>S. solfataricus oriC 3</h2>
    <div id="seq_container" class="seq_type">
        <span class="nucleotide" id="nuc_0">T</span><span class="nucleotide" id="nuc_1">A</span><span class="nucleotide" id="nuc_2">A</span><span class="nucleotide" id="nuc_3">A</span><span class="nucleotide" id="nuc_4">T</span><span class="nucleotide" id="nuc_5">T</span><span class="nucleotide" id="nuc_6">C</span><span class="nucleotide" id="nuc_7">T</span><span class="nucleotide" id="nuc_8">C</span><span class="nucleotide" id="nuc_9">C</span><span class="nucleotide" id="nuc_10">C</span><span class="nucleotide" id="nuc_11">T</span><span class="nucleotide" id="nuc_12">C</span><span class="nucleotide" id="nuc_13">C</span><span class="nucleotide" id="nuc_14">T</span><span class="nucleotide" id="nuc_15">A</span><span class="nucleotide" id="nuc_16">C</span><span class="nucleotide" id="nuc_17">T</span><span class="nucleotide" id="nuc_18">T</span><span class="nucleotide" id="nuc_19">G</span><span class="nucleotide" id="nuc_20">C</span><span class="nucleotide" id="nuc_21">T</span><span class="nucleotide" id="nuc_22">A</span><span class="nucleotide" id="nuc_23">T</span><span class="nucleotide" id="nuc_24">A</span><span class="nucleotide" id="nuc_25">A</span><span class="nucleotide" id="nuc_26">C</span><span class="nucleotide" id="nuc_27">T</span><span class="nucleotide" id="nuc_28">T</span><span class="nucleotide" id="nuc_29">T</span><span class="nucleotide" id="nuc_30">C</span><span class="nucleotide" id="nuc_31">A</span><span class="nucleotide" id="nuc_32">G</span><span class="nucleotide" id="nuc_33">A</span><span class="nucleotide" id="nuc_34">A</span><span class="nucleotide" id="nuc_35">C</span><span class="nucleotide" id="nuc_36">A</span><span class="nucleotide" id="nuc_37">A</span><span class="nucleotide" id="nuc_38">A</span><span class="nucleotide" id="nuc_39">G</span><span class="nucleotide" id="nuc_40">A</span><span class="nucleotide" id="nuc_41">T</span><span class="nucleotide" id="nuc_42">T</span><span class="nucleotide" id="nuc_43">A</span><span class="nucleotide" id="nuc_44">A</span><span class="nucleotide" id="nuc_45">A</span><span class="nucleotide" id="nuc_46">T</span><span class="nucleotide" id="nuc_47">A</span><span class="nucleotide" id="nuc_48">G</span><span class="nucleotide" id="nuc_49">A</span><span class="nucleotide" id="nuc_50">T</span><span class="nucleotide" id="nuc_51">T</span><span class="nucleotide" id="nuc_52">A</span><span class="nucleotide" id="nuc_53">C</span><span class="nucleotide" id="nuc_54">T</span><span class="nucleotide" id="nuc_55">A</span><span class="nucleotide" id="nuc_56">C</span><span class="nucleotide" id="nuc_57">T</span><span class="nucleotide" id="nuc_58">A</span><span class="nucleotide" id="nuc_59">C</span><br/>
<span class="nucleotide" id="nuc_60">T</span><span class="nucleotide" id="nuc_61">A</span><span class="nucleotide" id="nuc_62">C</span><span class="nucleotide" id="nuc_63">T</span><span class="nucleotide" id="nuc_64">C</span><span class="nucleotide" id="nuc_65">A</span><span class="nucleotide" id="nuc_66">T</span><span class="nucleotide" id="nuc_67">A</span><span class="nucleotide" id="nuc_68">T</span><span class="nucleotide" id="nuc_69">G</span><span class="nucleotide" id="nuc_70">T</span><span class="nucleotide" id="nuc_71">T</span><span class="nucleotide" id="nuc_72">T</span><span class="nucleotide" id="nuc_73">C</span><span class="nucleotide" id="nuc_74">C</span><span class="nucleotide" id="nuc_75">G</span><span class="nucleotide" id="nuc_76">T</span><span class="nucleotide" id="nuc_77">C</span><span class="nucleotide" id="nuc_78">T</span><span class="nucleotide" id="nuc_79">T</span><span class="nucleotide" id="nuc_80">A</span><span class="nucleotide" id="nuc_81">G</span><span class="nucleotide" id="nuc_82">A</span><span class="nucleotide" id="nuc_83">G</span><span class="nucleotide" id="nuc_84">C</span><span class="nucleotide" id="nuc_85">T</span><span class="nucleotide" id="nuc_86">T</span><span class="nucleotide" id="nuc_87">T</span><span class="nucleotide" id="nuc_88">A</span><span class="nucleotide" id="nuc_89">A</span><span class="nucleotide" id="nuc_90">A</span><span class="nucleotide" id="nuc_91">A</span><span class="nucleotide" id="nuc_92">C</span><span class="nucleotide" id="nuc_93">G</span><span class="nucleotide" id="nuc_94">A</span><span class="nucleotide" id="nuc_95">A</span><span class="nucleotide" id="nuc_96">A</span><span class="nucleotide" id="nuc_97">G</span><span class="nucleotide" id="nuc_98">G</span><span class="nucleotide" id="nuc_99">T</span><span class="nucleotide" id="nuc_100">T</span><span class="nucleotide" id="nuc_101">T</span><span class="nucleotide" id="nuc_102">G</span><span class="nucleotide" id="nuc_103">T</span><span class="nucleotide" id="nuc_104">A</span><span class="nucleotide" id="nuc_105">T</span><span class="nucleotide" id="nuc_106">A</span><span class="nucleotide" id="nuc_107">A</span><span class="nucleotide" id="nuc_108">T</span><span class="nucleotide" id="nuc_109">T</span><span class="nucleotide" id="nuc_110">T</span><span class="nucleotide" id="nuc_111">T</span><span class="nucleotide" id="nuc_112">C</span><span class="nucleotide" id="nuc_113">C</span><span class="nucleotide" id="nuc_114">C</span><span class="nucleotide" id="nuc_115">C</span><span class="nucleotide" id="nuc_116">A</span><span class="nucleotide" id="nuc_117">A</span><span class="nucleotide" id="nuc_118">T</span><span class="nucleotide" id="nuc_119">A</span><br/>
<span class="nucleotide" id="nuc_120">T</span><span class="nucleotide" id="nuc_121">G</span><span class="nucleotide" id="nuc_122">C</span><span class="nucleotide" id="nuc_123">C</span><span class="nucleotide" id="nuc_124">C</span><span class="nucleotide" id="nuc_125">A</span><span class="nucleotide" id="nuc_126">T</span><span class="nucleotide" id="nuc_127">A</span><span class="nucleotide" id="nuc_128">G</span><span class="nucleotide" id="nuc_129">A</span><span class="nucleotide" id="nuc_130">A</span><span class="nucleotide" id="nuc_131">G</span><span class="nucleotide" id="nuc_132">T</span><span class="nucleotide" id="nuc_133">A</span><span class="nucleotide" id="nuc_134">T</span><span class="nucleotide" id="nuc_135">A</span><span class="nucleotide" id="nuc_136">A</span><span class="nucleotide" id="nuc_137">C</span><span class="nucleotide" id="nuc_138">T</span><span class="nucleotide" id="nuc_139">T</span><span class="nucleotide" id="nuc_140">A</span><span class="nucleotide" id="nuc_141">A</span><span class="nucleotide" id="nuc_142">G</span><span class="nucleotide" id="nuc_143">C</span><span class="nucleotide" id="nuc_144">T</span><span class="nucleotide" id="nuc_145">A</span><span class="nucleotide" id="nuc_146">A</span><span class="nucleotide" id="nuc_147">C</span><span class="nucleotide" id="nuc_148">A</span><span class="nucleotide" id="nuc_149">C</span><span class="nucleotide" id="nuc_150">A</span><span class="nucleotide" id="nuc_151">T</span><span class="nucleotide" id="nuc_152">A</span><span class="nucleotide" id="nuc_153">G</span><span class="nucleotide" id="nuc_154">T</span><span class="nucleotide" id="nuc_155">A</span><span class="nucleotide" id="nuc_156">G</span><span class="nucleotide" id="nuc_157">T</span><span class="nucleotide" id="nuc_158">A</span><span class="nucleotide" id="nuc_159">G</span><span class="nucleotide" id="nuc_160">T</span><span class="nucleotide" id="nuc_161">A</span><span class="nucleotide" id="nuc_162">A</span><span class="nucleotide" id="nuc_163">A</span><span class="nucleotide" id="nuc_164">T</span><span class="nucleotide" id="nuc_165">A</span><span class="nucleotide" id="nuc_166">A</span><span class="nucleotide" id="nuc_167">T</span><span class="nucleotide" id="nuc_168">T</span><span class="nucleotide" id="nuc_169">A</span><span class="nucleotide" id="nuc_170">T</span><span class="nucleotide" id="nuc_171">A</span><span class="nucleotide" id="nuc_172">A</span><span class="nucleotide" id="nuc_173">A</span><span class="nucleotide" id="nuc_174">A</span><span class="nucleotide" id="nuc_175">G</span><span class="nucleotide" id="nuc_176">G</span><span class="nucleotide" id="nuc_177">A</span><span class="nucleotide" id="nuc_178">G</span><span class="nucleotide" id="nuc_179">A</span><br/>
<span class="nucleotide" id="nuc_180">A</span><span class="nucleotide" id="nuc_181">G</span><span class="nucleotide" id="nuc_182">A</span><span class="nucleotide" id="nuc_183">G</span><span class="nucleotide" id="nuc_184">A</span><span class="nucleotide" id="nuc_185">A</span><span class="nucleotide" id="nuc_186">A</span><span class="nucleotide" id="nuc_187">G</span>
    </div>
    <h2>Kmers (k=9)</h2>
    <div id="kmers" class="kmer_list">
    </div>
</body>
</html>
<script>
    $( document ).ready(function() {

        console.log("len="+window.kmers.length);
        var cnt = 0
        for(var nkmer=0; nkmer < window.kmers.length; nkmer++) {
            $("#kmers").append("<h3>num="+window.kmers[nkmer][0]+"</h3>")
            for(var k=1;k<window.kmers[nkmer].length; k++) {
                $("#kmers").append("<span class=\"kmer_pair\" id=\"kmer_"+cnt+
                        "\"><span class=\"sel_seq\">"+window.kmers[nkmer][k][0]+
                        "</span>/<span class=\"rev_seq\">"+window.kmers[nkmer][k][2]+
                        "</span></span> ");
                function resetHighlight() {
                    for( var i=0; i<window.seqlen; i++) {
                        $("#nuc_"+i).removeClass("sel_seq");
                        $("#nuc_"+i).removeClass("rev_seq");
                        $("#nuc_"+i).removeClass("mismatch_seq");
                        $("#nuc_"+i).removeClass("overlap_seq");
                    }
                }
                function resetSelected() {
                    $(".kmer_pair").removeClass("selected_item");
                }
                function otherClass(clss) {
                    if( clss == "sel_seq") {
                        return("rev_seq");
                    } else if( clss == "rev_seq") {
                        return("sel_seq");
                    }
                }
                function highlightKmer(index, clss, kmerStr) {
                    for(var i=0; i<window.kvalue; i++ ) {
                        var pos=index+i;
                        if( $("#nuc_"+pos).hasClass(otherClass(clss)) ||
                                $("#nuc_"+pos).hasClass(clss)) {
                            $("#nuc_"+pos).addClass("overlap_seq");
                        }
                        $("#nuc_"+pos).addClass(clss);
                        if( $("#nuc_"+pos).text() != kmerStr[i] ) {
                            $("#nuc_"+pos).addClass("mismatch_seq");
                        }
                    }
                }
                function bindHighlightFun(n, k, cnt) {
                    $("#kmer_"+cnt).click(function() {
                        resetSelected();
                        $("#kmer_"+cnt).toggleClass("selected_item");
                        resetHighlight();
                        for( var j=0; j<window.kmers[n][k][1].length; j++) {
                            var index = window.kmers[n][k][1][j];
                            highlightKmer(index, "sel_seq", window.kmers[n][k][0])
                        }
                        for( var j=0; j<window.kmers[n][k][3].length; j++) {
                            var index = window.kmers[n][k][3][j];
                            highlightKmer(index, "rev_seq", window.kmers[n][k][2]);
                        }
                    });
                }
                bindHighlightFun(nkmer, k, cnt);
                cnt += 1;
            }

        }

    });
//    }
</script>
